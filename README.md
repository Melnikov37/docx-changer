# DOCX Template Filler

Веб-приложение для заполнения DOCX документов по шаблонам с использованием тегов Jinja2.

## ✨ Новое в версии 2.0

**Динамические формы!** Теперь не нужно писать JSON вручную:
1. Загрузите DOCX шаблон
2. Приложение автоматически извлечет все теги
3. Вы увидите готовую форму с полями для заполнения
4. Просто заполните поля и нажмите "Сгенерировать"

Все еще можете использовать режим JSON для сложных случаев.

## Установка

1. Убедитесь, что у вас установлен Python 3.9 или выше:
```bash
python3 --version
```

2. Создайте виртуальное окружение:
```bash
python3 -m venv venv
source venv/bin/activate  # На Windows: venv\Scripts\activate
```

3. Установите зависимости:
```bash
pip install -r requirements.txt
```

## Запуск приложения

```bash
python app.py
```

Приложение будет доступно по адресу: `http://localhost:5000`

## Как использовать

### Способ 1: Использование динамических форм (рекомендуется)

1. **Создайте DOCX шаблон** в Microsoft Word с тегами Jinja2
2. **Загрузите шаблон** в веб-интерфейс (перетащите или выберите файл)
3. **Дождитесь парсинга** - приложение автоматически найдет все теги
4. **Заполните форму** - для каждого тега появится поле ввода:
   - Простые поля: текстовые input'ы
   - Boolean поля: чекбоксы
   - Массивы: динамические формы с кнопками "Добавить" / "Удалить"
5. **Нажмите "Сгенерировать документ"**
6. **Скачайте готовый файл**

### Способ 2: Использование JSON (для опытных пользователей)

Переключитесь в режим "JSON" и введите данные вручную.

### 1. Создание шаблона DOCX

Откройте Microsoft Word и создайте документ с тегами Jinja2:

#### Простые переменные
```
Имя: {{name}}
Дата: {{date}}
Компания: {{company}}
```

#### Списки и таблицы
Для создания повторяющихся элементов используйте циклы:

```
{% for item in items %}
- {{item.name}}: {{item.price}} руб.
{% endfor %}
```

Для таблиц в Word:
1. Создайте таблицу с заголовками
2. Во второй строке добавьте теги
3. Поместите вторую строку внутрь цикла:

```
{% for product in products %}
| {{product.name}} | {{product.price}} | {{product.quantity}} |
{% endfor %}
```

#### Условия
```
{% if has_discount %}
Скидка: {{discount}}%
{% endif %}
```

#### Фильтры
```
{{name|upper}}           - ВЕРХНИЙ РЕГИСТР
{{text|lower}}           - нижний регистр
{{text|capitalize}}      - Заглавная первая буква
{{number|round(2)}}      - округление до 2 знаков
```

### 2. Подготовка данных JSON

Создайте JSON объект с данными для заполнения:

```json
{
  "name": "Иван Иванов",
  "date": "25.01.2026",
  "company": "ООО Пример",
  "has_discount": true,
  "discount": 10,
  "items": [
    {"name": "Товар 1", "price": "1000"},
    {"name": "Товар 2", "price": "2000"}
  ],
  "products": [
    {"name": "Ноутбук", "price": "50000", "quantity": "2"},
    {"name": "Мышь", "price": "500", "quantity": "5"}
  ]
}
```

### 3. Генерация документа

1. Откройте приложение в браузере
2. Загрузите DOCX шаблон (перетащите файл или выберите через диалог)
3. Вставьте JSON данные в текстовое поле
4. Нажмите "Сгенерировать документ"
5. Скачайте готовый файл

## Примеры

В директории `docx_templates/` находится файл `example.docx` с примером шаблона.

## Структура проекта

```
docx-changer/
├── app.py                  # Flask приложение
├── requirements.txt        # Зависимости
├── README.md              # Документация
├── templates/             # HTML шаблоны
│   └── index.html
├── static/
│   ├── css/
│   │   └── style.css
│   └── js/
│       └── app.js
├── docx_templates/       # Шаблоны DOCX
│   └── example.docx
├── uploads/              # Временные файлы
└── output/               # Результаты
```

## Возможные проблемы

### Ошибка "Invalid JSON"
Проверьте корректность JSON:
- Все строки в двойных кавычках
- Запятые между элементами
- Нет запятой после последнего элемента

### Переменная не заменяется
- Проверьте точное совпадение имен в шаблоне и JSON
- Учитывайте регистр букв
- Убедитесь, что синтаксис тегов правильный: `{{variable}}`, а не `{variable}`

### Кириллица отображается некорректно
- Убедитесь, что DOCX файл создан в UTF-8
- Проверьте, что JSON данные в UTF-8

## Безопасность

- Максимальный размер загружаемого файла: 10 MB
- Поддерживаются только файлы с расширением .docx
- Временные файлы автоматически удаляются после генерации
- Приложение предназначено для локального использования
