# Быстрый старт

> **Новое в 2.0:** Динамические формы! Не нужно писать JSON - просто загрузите шаблон и заполните поля.

## 1. Установка и запуск (2 минуты)

```bash
# Перейти в директорию проекта
cd /Users/m.melnikov/projects/docx-changer

# Активировать виртуальное окружение
source venv/bin/activate

# Запустить приложение
python app.py
```

Приложение запустится на: **http://localhost:5000**

## 2. Первый документ (1 минута)

### Вариант А: С динамической формой (проще)

1. Откройте в браузере: http://localhost:5000
2. Перетащите файл `docx_templates/example.docx` в форму
3. Подождите 2 секунды - появится форма с полями
4. Заполните поля (например, введите свое имя, дату, компанию)
5. Нажмите "Сгенерировать документ"
6. Скачайте готовый файл ✅

### Вариант Б: С JSON (традиционный способ)

1. Откройте в браузере: http://localhost:5000
2. Переключитесь в режим "JSON" (кнопка вверху справа)
3. Перетащите файл `docx_templates/example.docx`
4. Скопируйте пример JSON из правой панели
5. Нажмите "Сгенерировать документ"
6. Скачайте готовый файл

## 3. Создание своего шаблона

### Шаг 1: Создайте DOCX в Word

Откройте Microsoft Word и создайте документ со следующим содержимым:

```
Договор на оказание услуг

Заказчик: {{client_name}}
Дата: {{date}}

Услуги:
{% for service in services %}
- {{service.name}}: {{service.price}} руб.
{% endfor %}

Итого: {{total}} руб.
```

Сохраните как `my_template.docx`

### Шаг 2: Подготовьте JSON данные

```json
{
  "client_name": "ООО Пример",
  "date": "25.01.2026",
  "total": "50000",
  "services": [
    {"name": "Консультация", "price": "25000"},
    {"name": "Внедрение", "price": "25000"}
  ]
}
```

### Шаг 3: Сгенерируйте документ

1. Загрузите `my_template.docx` в веб-интерфейс
2. Вставьте JSON данные
3. Нажмите "Сгенерировать документ"
4. Готово!

## Основные теги Jinja2

| Тег | Описание | Пример |
|-----|----------|--------|
| `{{variable}}` | Простая переменная | `{{name}}` |
| `{% for item in list %}...{% endfor %}` | Цикл | `{% for user in users %}{{user.name}}{% endfor %}` |
| `{% if condition %}...{% endif %}` | Условие | `{% if has_discount %}Скидка!{% endif %}` |
| `{{text\|upper}}` | Фильтр (верхний регистр) | `{{name\|upper}}` |

## Полезные команды

```bash
# Остановить сервер
# Нажмите Ctrl+C в терминале где запущен app.py

# Посмотреть все сгенерированные документы
ls -lh output/

# Очистить временные файлы
rm -f output/*.docx
rm -f uploads/*.docx

# Деактивировать виртуальное окружение
deactivate
```

## Устранение проблем

### Ошибка "Port 5000 already in use"

```bash
# Найти процесс, использующий порт 5000
lsof -i :5000

# Остановить процесс (замените PID на актуальный)
kill -9 PID
```

### Ошибка "Invalid JSON"

- Проверьте, что все строки в двойных кавычках: `"text"`
- Используйте запятые между элементами, но НЕ после последнего
- Проверьте закрытие всех скобок `{}` и `[]`

### Кириллица отображается неправильно

- Убедитесь, что DOCX файл создан в современной версии Word
- Проверьте, что JSON файл в UTF-8 (должно быть по умолчанию)

## Следующие шаги

- Прочитайте полную документацию: [README.md](README.md)
- Изучите пример шаблона: `docx_templates/example.docx`
- Посмотрите пример данных: `example_data.json`
